---
layout: post
title: SVN 最佳实践
tags:
- svn
---

本文整理翻译自 [stackoverflow.com: SVN best-practices - working in a team](http://stackoverflow.com/questions/417599/svn-best-practices-working-in-a-team?answertab=votes#tab-top)

### 问：SVN 在团队协助中的最佳实践

我刚开始使用 SVN。我已经了解了最基本的命令并且理解基本原则。我希望有人能够给我一些在团队开发中使用 SVN 的最佳实践。

我能明白在提交代码的时候添加有用且冗长的消息的好处，但是还有其他需要注意的吗？

谢谢所有的答案——你们给我很大的帮助。

*-by codeinthehole*

### 1. Gordon Wilson

**鼓励频繁提交** 刚开始使用版本控制的团队成员可能会觉得它们不能提交代码到仓库，直到“能够正确运行**。
告诉每个人应该尽早提交代码并且经常尽快的找到问题。不要等到可以运行才提交，或者因为担心破坏主干而让你的团队成员创建分支来开发功能. 那将导致...

**创建分支并且使用标签** 除了使用分支来开发新功能，鼓励你的团队成员使用分支来做大 bug 的修复。 在修复 bug 之前和之后打上标签。维护开发/qa 发布的标签（也可以是分支）。

**创建一个主干的使用规章并且贴起来** 一个可能的例子：主干必须一直能正确编译, 或者 “主干必须一直能通过所有单元测试”。 任何不能达到主干标准的工作必须在分支中完成。

### 2. Tom Ritter

**不要把代码格式化和代码修改一起提交**

如果你想重新格式化一个大文件的空格(`Control` + `K` + `D`), 可以。 但是请把这个提交和真正的逻辑修改分开提交。如果你想移动文件中的方法也一样。 把移动和真正的编辑分开提交。

### 3. rmeador

一个我通常坚持的最关键的原则是 **把相关的代码修改一起提交** 。
另外一个必然的要点是：不要在一次提交中提交不相关的代码修改。
这意味着不要在一次提交中修复两个 bug(除非它们是同样的修复), 不要把一个 bug 的修复分在两次提交中。 
同样的，当我需要添加一些优化的代码或者与系统其他部分不相关的部分且需要稍后进行其他工作的，我会单独提交优化的代码（并且先提交）。
可以想象任何人想要每个单独的更改（或者回滚到它）都应该单独提交。
这将大大减少由于合并或者回滚损坏的功能点的时候引起的头痛。

### 4. vboctor

大家已经提到了很多了，下面是一些其他的：

1. 如果你有一些不想放到版本控制的文件（例如配置文件，编译后的文件等）,把他们添加到忽略列表。这样的话你你就会注意到忘记添加到SVN的文件了。
2. 添加一个邮件发送程序，当你提交的时候发送邮件到你的开发者邮件列表（或者一个特殊为此的帐号）,关联提交更改和patch。
3. 融入你的 Bug 追踪系统，引用指向 bug 修复或者功能的文件差异的链接。像 [MantisBT](http://www.mantisbt.org/) 这样的 Bug 追踪系统支持这个功能。
4. 考虑融入连续融合（例如：[CruiseControl.NET](http://sourceforge.net/projects/ccnet)）, [NAnt](http://nant.sourceforge.net/) 用于编译，[NUnit](http://nunit.org/)或者 VS 用于单元测试。这样一旦某个用户签入了代码或者间隔一定时间的代码编译发送，单元测试就将自动运行，并且开发人员会得到测试进程的反馈。如果代码仓库出错了(例如编译失败)这同样也会提醒团队中的其他人。

### 5. Electri Monk

好吧，基本的：

+ 在版本的 QA 之前创建一个标签
+ 在有危险的修改（例如大的重构）前创建标签
+ 为了冻结代码，创建一个分支用于发行版本
+ 确保每个人知道在开始工作前和提交代码前更新
+ SVN 允许不同的用户签出同样的文件。确保每个人解决任何产生的冲突。
+ 绝对不要给超过一个用户使用同一个 SVN 帐号。这可能导致可怕的事情。

### 6. hromanko

这里的人们给的答案都很棒。其中的大多数已经总结到了 svn 用户文档 [SVN 最佳实践](http://svn.apache.org/repos/asf/subversion/trunk/doc/user/svn-best-practices.html)

重复一下：

1. 设置你的仓库结构（你的项目根目录应该包含 trunk, branches, tags 文件夹）
2. 选择你的分支策略（私有分支，每个里程碑/发布/bug分支，等）并且粘贴下来——我推荐多使用分支，但是不要使用私有分支。
3. 选定你的标签策略——越多越好，但是更重要的是你的标签的命名习俗。
4. 选定你的提交到主干的策略——尽可能保持主干的干净，它应该随时处于可发布状态。

## 总结

还有一些回答的投票数在 10 票以下，这里不再摘录了。根据我的经验结合这些答案，我认为以下是一些非常重要的原则：

1. 建立规范的仓库结构(trunk,branches,tags)；
2. 尽可能多 commit，每次 commit 尽量只提交一个修改；
3. 制定一个约定，并且遵守，不要纠结于代码风格；
4. 利用好分支，如果一次修改较大，请在分支上完成。
