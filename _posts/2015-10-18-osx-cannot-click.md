---
layout: post
title: OSX 触摸板无法点击问题的解决
---

最近几个月来，经常中午吃完饭回来后发现触摸板无法点击，但是键盘可以输入，也可以切换程序，只是触摸板点击无反应，每次都只能以重启电脑来解决。

我中午吃饭的时候习惯把 Magic Mouse 关掉，扣上 Mac，关掉第二显示器。回来后，就打开屏幕，打开鼠标，手动到连接蓝牙。

但是最近隔几天就会出现一次打开电脑后无法响应点击触摸板的现象。

我首先怀疑是系统有问题，因为 OSX 10.10 系统 Bug 很多，我怀疑这也是一个 Bug，不过最近刚刚升级了 OSX 10.11 El Captain，偶尔却还是有这个现象。

我也怀疑是因为用了外接显示器的原因，我尝试过拔掉显示器，却还是不能恢复。

到网上搜了很久，试了很多关键字，没有发现有这个问题。有一个类似的问题，有人说这是一个系统的问题，可以在偏好设置中开启键盘键，在触摸板无法响应的时候，按下 Fn 5次来启用把键盘作为鼠标，然后等一段时间就自动好了。

虽然这是一个权宜之计，我还是照着设置上了，不过出问题的时候，我发现想启用键盘键却忘了怎么开启了，试着开启也没有效果。

终于，今天晚上我收拾东西回家的时候，我关掉 Magic Mouse，然后突然发现屏幕上多了一个选框，我在触摸板上移动的时候，选框也会改变，也就是鼠标处于被按下的状态。
但是我并没有按住触控板，我尝试按了几次也不能取消这种状态，我突然想起来可能是因为 Magic Mouse 被按下了，没有松起来，所以鼠标一直就处于按下的状态，导致我按触摸板也无效了。

而且由于可以切换程序，切换了程序以后，鼠标不会看起来像按下去的，也不会有选框，可以正常移动，只是不响应点按操作。让人完全不知道怎么回事，只能通过重启电脑来解决。

我尝试重新打开 Magic Mouse，不过由于无法设置蓝牙连接，所以我不能手动连接上鼠标，幸好等了 10 多秒以后鼠标自动连接上了，果然我按了一下 Magic Mouse 之后鼠标就恢复了，触摸板也可以使用了。

我想了一下，OSX 应该是在监听鼠标事件时记录了事件来源，Magic Mouse 的 `mousedown` 事件只能对应 Magic Mouse 的 `mouseup` 事件，`mousedown` 以后鼠标就被关闭了，导致收不到 `mouseup` 事件，所以也一直处于按下的状态，这应该是 OSX 的一个 Bug。

这可能是我们开发人员可能经常会犯的一个错误，用常理去推断，确实一般来说一个 `mousedown` 接下来是应该一定会有一个 `mouseup`，只有很小概率的情况下 `mousedown` 了之后鼠标断开了，无法收到 `mouseup` 事件，这种是几乎可以忽略掉的。
然而，由于 Magic Mouse 独特的构造，使得想关闭鼠标几乎都会按下按键，造成了这个事件的概率增大了很多，所以很容易出现这个 Bug，又由于用户关掉鼠标，可能是要暂停工作，只有等一段事件恢复工作的时候才会发现出了问题，这中间时间较长，很难将触摸板的不响应和 Magic Mouse 联系起来，让人一头雾水。
而且中午吃饭的时候关掉 Magic Mouse 是我一个人的一个小习惯，很多用户并不会这样做，所以这也造成这个问题出现不多，并且会在有这样习惯的人身上频繁出现，让我这样人一度怀疑自己是不是有什么问题。

我也经常忽略掉一些自认为是小概率的事件，最近软件中也出现了一些只有个别用户频繁出现的现象，我们经常会认为是用户的设备有问题，而且由于难以复现，就只能搁置一边，基本不会处理。
这是否可能也是由于部分用户独特的使用习惯造成的呢？


